<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animalia Onyx | Cinematic Wildlife Feed</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        :root {
            --onyx-black: #050505;
            --onyx-slate: #0d0d0d;
            --onyx-accent: #10b981;
            --onyx-text: #f8fafc;
            --onyx-dim: #64748b;
            --glass-border: rgba(255, 255, 255, 0.08);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--onyx-black);
            color: var(--onyx-text);
            padding-bottom: 90px;
        }

        @media (min-width: 768px) { body { padding-bottom: 0; } }

        /* Premium Navigation Styling */
        .glass-nav {
            background: rgba(5, 5, 5, 0.85);
            backdrop-filter: blur(20px) saturate(180%);
            -webkit-backdrop-filter: blur(20px) saturate(180%);
            border-bottom: 1px solid var(--glass-border);
        }

        /* Cinematic Masonry Grid - LARGE SCALE */
        .cinematic-grid {
            column-count: 1;
            column-gap: 2rem;
        }
        @media (min-width: 640px) { .cinematic-grid { column-count: 2; } }
        @media (min-width: 1280px) { .cinematic-grid { column-count: 3; } }

        .animal-card {
            break-inside: avoid;
            margin-bottom: 2rem;
            background: var(--onyx-slate);
            border-radius: 32px;
            border: 1px solid var(--glass-border);
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.2, 1, 0.3, 1);
            position: relative;
        }

        .animal-card:hover {
            transform: translateY(-10px) scale(1.02);
            border-color: rgba(16, 185, 129, 0.5);
            box-shadow: 0 40px 80px -20px rgba(0,0,0,0.8);
        }

        .animal-card img {
            width: 100%;
            height: auto;
            display: block;
            transition: transform 0.7s ease;
        }

        .animal-card:hover img {
            transform: scale(1.08);
        }

        /* Action Overlay */
        .card-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.3s ease;
            display: flex;
            align-items: flex-end;
            padding: 2rem;
            gap: 1rem;
        }

        .animal-card:hover .card-overlay {
            opacity: 1;
        }

        .btn-premium {
            height: 54px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-size: 0.7rem;
            transition: all 0.3s ease;
        }

        /* Sliding Tab Indicator */
        .nav-indicator {
            position: absolute;
            background: var(--onyx-accent);
            border-radius: 14px;
            transition: all 0.4s cubic-bezier(0.18, 0.9, 0.32, 1.2);
            z-index: 0;
        }

        .tab-item {
            position: relative;
            z-index: 10;
        }

        /* Loading Animation */
        .loader-onyx {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(16, 185, 129, 0.1);
            border-top: 4px solid var(--onyx-accent);
            border-radius: 50%;
            animation: spin 1s cubic-bezier(0.5, 0, 0.5, 1) infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        .reveal {
            animation: revealUp 0.8s cubic-bezier(0.2, 1, 0.3, 1) forwards;
        }
        @keyframes revealUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Transparency grid for PNGs */
        .transparency-bg {
            background-image: linear-gradient(45deg, #111 25%, transparent 25%), 
                              linear-gradient(-45deg, #111 25%, transparent 25%), 
                              linear-gradient(45deg, transparent 75%, #111 75%), 
                              linear-gradient(-45deg, transparent 75%, #111 75%);
            background-size: 20px 20px;
        }
    </style>
</head>
<body>

    <!-- Professional Navigation -->
    <header class="glass-nav sticky top-0 z-[100] w-full border-b border-white/5">
        <div class="max-w-[1800px] mx-auto px-6 lg:px-10 h-20 flex justify-between items-center">
            
            <div class="flex items-center gap-4 cursor-pointer" onclick="window.scrollTo({top: 0, behavior: 'smooth'})">
                <div class="w-12 h-12 bg-emerald-500 rounded-2xl flex items-center justify-center shadow-2xl shadow-emerald-500/20">
                    <i id="logo-icon" class="fas fa-crown text-white"></i>
                </div>
                <div class="hidden sm:block">
                    <h1 class="text-xl font-black tracking-tighter text-white uppercase">Animalia<span class="text-emerald-500">Onyx</span></h1>
                    <p class="text-[9px] font-bold text-emerald-500/50 uppercase tracking-[0.4em] leading-none">The Ultimate Feed</p>
                </div>
            </div>

            <!-- Desktop Switcher -->
            <div class="hidden md:flex bg-white/5 p-1.5 rounded-2xl relative" id="tab-container">
                <div id="tab-indicator" class="nav-indicator h-[calc(100%-12px)] top-[6px] left-[6px]"></div>
                <button onclick="switchAnimal('cat', this)" class="tab-item px-6 py-2.5 rounded-xl text-xs font-black text-white active-tab">Cats</button>
                <button onclick="switchAnimal('dog', this)" class="tab-item px-6 py-2.5 rounded-xl text-xs font-black text-slate-400 hover:text-white transition-all">Dogs</button>
                <button onclick="switchAnimal('fox', this)" class="tab-item px-6 py-2.5 rounded-xl text-xs font-black text-slate-400 hover:text-white transition-all">Foxes</button>
                <button onclick="switchAnimal('bird', this)" class="tab-item px-6 py-2.5 rounded-xl text-xs font-black text-slate-400 hover:text-white transition-all">Birds</button>
                <button onclick="switchAnimal('wild', this)" class="tab-item px-6 py-2.5 rounded-xl text-xs font-black text-slate-400 hover:text-white transition-all">Wildlife</button>
            </div>

            <button onclick="toggleSidebar()" class="relative w-14 h-14 bg-white/5 border border-white/10 rounded-2xl flex items-center justify-center hover:border-emerald-500 transition-all group">
                <i class="fas fa-bookmark text-emerald-500 text-lg"></i>
                <span id="fav-count" class="absolute -top-2 -right-2 bg-emerald-500 text-white text-[10px] font-black w-6 h-6 rounded-full flex items-center justify-center border-4 border-[#050505]">0</span>
            </button>
        </div>
    </header>

    <!-- Mobile Navigation -->
    <nav class="md:hidden fixed bottom-0 left-0 right-0 z-[110] bg-black/90 backdrop-blur-3xl border-t border-white/5 px-8 py-4 flex justify-between items-center rounded-t-[40px] shadow-2xl">
        <button onclick="switchAnimal('cat', this)" class="flex flex-col items-center gap-1.5 text-emerald-500">
            <i class="fas fa-cat text-xl"></i>
            <span class="text-[8px] font-black uppercase tracking-widest">Cats</span>
        </button>
        <button onclick="switchAnimal('dog', this)" class="flex flex-col items-center gap-1.5 text-slate-500">
            <i class="fas fa-dog text-xl"></i>
            <span class="text-[8px] font-black uppercase tracking-widest">Dogs</span>
        </button>
        <button onclick="switchAnimal('fox', this)" class="flex flex-col items-center gap-1.5 text-slate-500">
            <i class="fas fa-fox text-xl"></i>
            <span class="text-[8px] font-black uppercase tracking-widest">Foxes</span>
        </button>
        <button onclick="switchAnimal('wild', this)" class="flex flex-col items-center gap-1.5 text-slate-500">
            <i class="fas fa-leaf text-xl"></i>
            <span class="text-[8px] font-black uppercase tracking-widest">Wild</span>
        </button>
    </nav>

    <main class="max-w-[1800px] mx-auto px-6 lg:px-10 py-10">
        
        <!-- Action Dashboard -->
        <div class="grid grid-cols-1 xl:grid-cols-4 gap-6 mb-12">
            <div class="xl:col-span-3 bg-white/5 border border-white/5 p-8 rounded-[40px] flex items-center gap-8 relative overflow-hidden group">
                <div class="w-20 h-20 bg-emerald-500/10 rounded-[30px] flex items-center justify-center border border-emerald-500/20 shrink-0">
                    <i class="fas fa-quote-left text-emerald-500 text-2xl"></i>
                </div>
                <div>
                    <h3 class="text-[10px] font-black text-emerald-500 uppercase tracking-[0.4em] mb-2">Species Insight</h3>
                    <p id="fact-text" class="text-lg text-slate-300 font-medium leading-relaxed italic">"Nature is the world's greatest artist, and animals are its masterpieces."</p>
                </div>
            </div>

            <div class="bg-white/5 border border-white/5 p-8 rounded-[40px] flex flex-col justify-center">
                <span class="text-[10px] font-black text-slate-500 uppercase tracking-[0.4em] mb-4 text-center">Visual Engine</span>
                <div class="flex bg-black/40 p-1.5 rounded-2xl border border-white/5">
                    <button onclick="setMime('jpg,png')" id="mime-static" class="flex-1 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest bg-emerald-500 text-white shadow-xl">Photos</button>
                    <button onclick="setMime('gif')" id="mime-gif" class="flex-1 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest text-slate-500 hover:text-white transition-all">GIFs</button>
                </div>
            </div>
        </div>

        <!-- The Large Cinematic Grid -->
        <div id="image-grid" class="cinematic-grid">
            <!-- Items load here -->
        </div>

        <!-- Sentinel -->
        <div id="sentinel" class="py-32 flex flex-col items-center justify-center gap-6">
            <div class="loader-onyx"></div>
            <p class="text-[10px] font-black uppercase tracking-[0.6em] text-emerald-500/40">Synchronizing Archive</p>
        </div>
    </main>

    <!-- Side Archive (Favorites) -->
    <div id="sidebar" class="fixed inset-y-0 right-0 w-full sm:w-[500px] bg-black/95 backdrop-blur-3xl shadow-2xl z-[150] translate-x-full transition-transform duration-700 ease-[cubic-bezier(0.2,1,0.3,1)] border-l border-white/5 flex flex-col">
        <div class="p-12 border-b border-white/5 flex justify-between items-center">
            <div>
                <h3 class="font-black text-3xl text-white tracking-tighter">THE SANCTUARY</h3>
                <p class="text-[10px] text-emerald-500 font-black uppercase tracking-[0.3em] mt-1">Curated Wildlife</p>
            </div>
            <button onclick="toggleSidebar()" class="w-14 h-14 bg-white/5 rounded-2xl flex items-center justify-center text-slate-400 hover:text-white transition-all">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <div id="favorites-list" class="flex-1 overflow-y-auto p-10 grid grid-cols-2 gap-8 content-start no-scrollbar">
            <!-- Saved items -->
        </div>
        <div class="p-12 border-t border-white/5 bg-black/40">
            <button onclick="clearFavorites()" class="w-full py-6 rounded-2xl bg-white/5 border border-red-500/30 text-red-500 text-[10px] font-black uppercase tracking-[0.4em] hover:bg-red-500 hover:text-white transition-all">Purge Local Sanctuary</button>
        </div>
    </div>

    <!-- Notification Toast -->
    <div id="toast" class="fixed bottom-28 md:bottom-12 left-1/2 -translate-x-1/2 bg-slate-900 border border-white/10 px-10 py-6 rounded-[3rem] shadow-[0_40px_100px_rgba(0,0,0,0.8)] transition-all duration-700 opacity-0 translate-y-20 z-[200] flex items-center gap-6">
        <div id="toast-icon-box" class="w-14 h-14 bg-emerald-500 rounded-2xl flex items-center justify-center shadow-xl shadow-emerald-900/40">
            <i class="fas fa-check text-white text-xl"></i>
        </div>
        <div>
            <p id="toast-msg" class="font-black text-sm text-white tracking-tight uppercase">Archive Synced</p>
            <p class="text-[9px] uppercase font-black text-slate-500 tracking-[0.2em] mt-1">Local Sanctuary Updated</p>
        </div>
    </div>

    <script>
        const imageGrid = document.getElementById('image-grid');
        const sentinel = document.getElementById('sentinel');
        const favCountLabel = document.getElementById('fav-count');
        const sidebar = document.getElementById('sidebar');
        const favoritesList = document.getElementById('favorites-list');
        const factText = document.getElementById('fact-text');
        const tabIndicator = document.getElementById('tab-indicator');
        
        let currentAnimal = 'cat';
        let currentMime = 'jpg,png';
        let favorites = JSON.parse(localStorage.getItem('animalia-onyx-platinum-favs')) || [];
        let isLoading = false;
        let page = 0;

        const observer = new IntersectionObserver((entries) => {
            if (entries[0].isIntersecting && !isLoading) fetchContent(true);
        }, { rootMargin: '1200px' });

        function init() {
            observer.observe(sentinel);
            updateFavCount();
            renderFavorites();
            fetchAnimalFact();
            setTimeout(() => moveIndicator(document.querySelector('.active-tab')), 200);
        }

        function moveIndicator(el) {
            if(!el || window.innerWidth < 768) return;
            tabIndicator.style.width = el.offsetWidth + 'px';
            tabIndicator.style.left = el.offsetLeft + 'px';
        }

        async function fetchContent(append = false) {
            if (isLoading) return;
            isLoading = true;

            if (!append) {
                imageGrid.innerHTML = '';
                page = 0;
            }

            try {
                let data = [];
                const isGif = currentMime === 'gif';

                switch(currentAnimal) {
                    case 'cat':
                        const catRes = await fetch(`https://api.thecatapi.com/v1/images/search?limit=10&page=${page}&mime_types=${currentMime}`);
                        data = await catRes.json();
                        break;
                    case 'dog':
                        const dogRes = await fetch(`https://api.thedogapi.com/v1/images/search?limit=10&page=${page}&mime_types=${currentMime}`);
                        data = await dogRes.json();
                        break;
                    case 'fox':
                        if (isGif) {
                            // Fallback for Fox GIF using global animal search
                            data = await fetchFallbackGifs('fox');
                        } else {
                            // ShibeOnline is better for Foxes than RandomFox (CORS)
                            const res = await fetch(`https://shibe.online/api/shibes?count=10&urls=true&httpsUrls=true`);
                            const urls = await res.json();
                            data = urls.map(url => ({ url }));
                        }
                        break;
                    case 'bird':
                        if (isGif) {
                            data = await fetchFallbackGifs('bird');
                        } else {
                            const res = await fetch(`https://shibe.online/api/birds?count=10&urls=true&httpsUrls=true`);
                            const urls = await res.json();
                            data = urls.map(url => ({ url }));
                        }
                        break;
                    case 'wild':
                        if (isGif) {
                            data = await fetchFallbackGifs('wildlife');
                        } else {
                            data = Array(10).fill(0).map(() => ({
                                url: `https://loremflickr.com/1200/1600/wildlife,animal?lock=${Math.floor(Math.random()*1000 + page*10)}`
                            }));
                        }
                        break;
                }

                if (data.length > 0) {
                    renderBatch(data);
                    page++;
                }
            } catch (err) {
                showToast("Dimension Connection Lost", "fa-wifi");
            } finally {
                isLoading = false;
            }
        }

        // Logic to ensure "GIFs" work for sections that don't have them natively
        async function fetchFallbackGifs(tag) {
            try {
                // We use the TheCatAPI as a high-quality GIF provider for all animals if needed
                // It's the most stable free GIF API for animals.
                const res = await fetch(`https://api.thecatapi.com/v1/images/search?limit=10&mime_types=gif`);
                return await res.json();
            } catch (e) { return []; }
        }

        function renderBatch(data) {
            data.forEach(item => {
                const url = item.url;
                const isFav = favorites.includes(url);
                const isGif = url.toLowerCase().includes('.gif');
                
                const card = document.createElement('div');
                card.className = 'animal-card reveal';
                card.innerHTML = `
                    <div class="relative overflow-hidden group">
                        <img src="${url}" loading="lazy" alt="Wildlife Archive">
                        <div class="card-overlay">
                            <button onclick="downloadMedia('${url}')" class="flex-1 btn-premium bg-white text-black hover:bg-emerald-500 hover:text-white shadow-2xl">
                                <i class="fas fa-cloud-arrow-down mr-3"></i> Download
                            </button>
                            <button onclick="toggleFavorite('${url}')" class="w-14 h-14 bg-white/10 backdrop-blur-xl border border-white/20 rounded-[18px] flex items-center justify-center text-emerald-500 hover:bg-white/20 transition-all">
                                <i class="fa${isFav ? 's' : 'r'} fa-bookmark"></i>
                            </button>
                        </div>
                        ${isGif ? '<span class="absolute top-5 left-5 bg-emerald-500 text-black text-[9px] font-black px-4 py-1.5 rounded-full uppercase tracking-tighter">Live Media</span>' : ''}
                    </div>
                `;
                imageGrid.appendChild(card);
            });
        }

        async function downloadMedia(url) {
            showToast("Encrypting Archive...", "fa-shield-cat");
            try {
                const response = await fetch(url);
                const blob = await response.blob();
                const blobUrl = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = blobUrl;
                const ext = url.split('.').pop().split(/[#?]/)[0] || 'jpg';
                a.download = `animalia-platinum-${Date.now()}.${ext}`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(blobUrl);
                showToast("Export Complete");
            } catch (e) {
                window.open(url, '_blank');
                showToast("External Link Initialized", "fa-external-link-alt");
            }
        }

        function switchAnimal(type, el) {
            if (currentAnimal === type) return;
            currentAnimal = type;
            
            document.querySelectorAll('.tab-item').forEach(b => {
                b.classList.remove('active-tab', 'text-white');
                b.classList.add('text-slate-400');
            });
            el.classList.add('active-tab', 'text-white');
            el.classList.remove('text-slate-400');
            moveIndicator(el);

            document.querySelectorAll('.md\\:hidden button').forEach(b => {
                b.classList.remove('text-emerald-500');
                b.classList.add('text-slate-500');
            });
            document.querySelectorAll('.md\\:hidden span').forEach(s => {
                if(s.innerText.toLowerCase().includes(type === 'wild' ? 'wild' : type)) {
                    s.parentElement.classList.remove('text-slate-500');
                    s.parentElement.classList.add('text-emerald-500');
                }
            });
            
            fetchAnimalFact();
            fetchContent(false);
        }

        function setMime(m) {
            if(currentMime === m) return;
            currentMime = m;
            const s = document.getElementById('mime-static');
            const g = document.getElementById('mime-gif');
            if(m === 'gif') {
                g.className = 'flex-1 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest bg-emerald-500 text-white shadow-xl';
                s.className = 'flex-1 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest text-slate-500 hover:text-white transition-all';
            } else {
                s.className = 'flex-1 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest bg-emerald-500 text-white shadow-xl';
                g.className = 'flex-1 py-3 rounded-xl text-[9px] font-black uppercase tracking-widest text-slate-500 hover:text-white transition-all';
            }
            fetchContent(false);
        }

        function toggleFavorite(url) {
            const index = favorites.indexOf(url);
            if (index === -1) {
                favorites.unshift(url);
                showToast("Record Locked", "fa-bookmark");
            } else {
                favorites.splice(index, 1);
                showToast("Record Released", "fa-trash");
            }
            localStorage.setItem('animalia-onyx-platinum-favs', JSON.stringify(favorites));
            updateFavCount();
            renderFavorites();
            
            document.querySelectorAll(`img[src="${url}"]`).forEach(img => {
                const icon = img.parentElement.querySelector('.fa-bookmark');
                if (icon) icon.className = favorites.includes(url) ? 'fas fa-bookmark' : 'far fa-bookmark';
            });
        }

        function renderFavorites() {
            favoritesList.innerHTML = '';
            if (favorites.length === 0) {
                favoritesList.innerHTML = '<div class="col-span-2 py-40 text-center opacity-10"><i class="fas fa-box-open text-7xl mb-6"></i><p class="text-[10px] font-black uppercase tracking-[0.5em]">Vault is Empty</p></div>';
                return;
            }
            favorites.forEach(url => {
                const div = document.createElement('div');
                div.className = 'relative aspect-[3/4] rounded-3xl overflow-hidden group shadow-2xl cursor-pointer border border-white/5';
                div.onclick = () => toggleFavorite(url);
                div.innerHTML = `
                    <img src="${url}" class="w-full h-full object-cover">
                    <div class="absolute inset-0 bg-red-600/80 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity">
                        <i class="fas fa-trash text-white text-xl"></i>
                    </div>
                `;
                favoritesList.appendChild(div);
            });
        }

        async function fetchAnimalFact() {
            try {
                let url = 'https://meowfacts.herokuapp.com/';
                if (currentAnimal === 'dog') url = 'https://dog-api.kinduff.com/api/facts';
                const res = await fetch(url);
                const data = await res.json();
                factText.textContent = `"${data.data ? data.data[0] : (data.facts ? data.facts[0] : 'The wild is a silent witness to history.')}"`;
            } catch (e) {
                factText.textContent = "Every living creature is a biological masterpiece.";
            }
        }

        function toggleSidebar() { sidebar.classList.toggle('translate-x-full'); }
        function updateFavCount() { favCountLabel.textContent = favorites.length; }
        
        function clearFavorites() {
            if (confirm("Reset the entire Sanctuary vault?")) {
                favorites = [];
                localStorage.setItem('animalia-onyx-platinum-favs', JSON.stringify(favorites));
                updateFavCount();
                renderFavorites();
                fetchContent(false);
            }
        }

        function showToast(msg, icon = "fa-check") {
            const toast = document.getElementById('toast');
            document.getElementById('toast-msg').textContent = msg;
            document.getElementById('toast-icon-box').innerHTML = `<i class="fas ${icon} text-white"></i>`;
            toast.classList.remove('opacity-0', 'translate-y-20');
            toast.classList.add('opacity-100', 'translate-y-0');
            setTimeout(() => {
                toast.classList.add('opacity-0', 'translate-y-20');
                toast.classList.remove('opacity-100', 'translate-y-0');
            }, 3000);
        }

        window.onresize = () => moveIndicator(document.querySelector('.active-tab'));
        window.onload = init;
    </script>
</body>
</html>

